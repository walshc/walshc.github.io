<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistics 2 2023/24 Resit Solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="2023-resit-solutions_files/libs/clipboard/clipboard.min.js"></script>
<script src="2023-resit-solutions_files/libs/quarto-html/quarto.js"></script>
<script src="2023-resit-solutions_files/libs/quarto-html/popper.min.js"></script>
<script src="2023-resit-solutions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2023-resit-solutions_files/libs/quarto-html/anchor.min.js"></script>
<link href="2023-resit-solutions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2023-resit-solutions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2023-resit-solutions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2023-resit-solutions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2023-resit-solutions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistics 2 2023/24 Resit Solutions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="introduction">Introduction</h2>
<p>The dataset <a href="https://walshc.github.io/stats2/housing.csv"><code>housing.csv</code></a> contains data from a random sample of 250 <em>gemeenten</em> (municipalities) in the Netherlands. For each <em>gemeente</em> in the sample we observe:</p>
<ul>
<li>The average house price (measured in thousands of euros).</li>
<li>The population growth over the last 5 years.</li>
<li>The province the <em>gemeente</em> is located in.</li>
</ul>
<p>The twelve provinces of the Netherlands are Drenthe, Flevoland, Friesland, Gelderland, Groningen, Limburg, Noord-Brabant, Noord-Holland, Overijssel, Utrecht, Zeeland and Zuid-Holland.</p>
<p>For the purpose of this exam, the <em>Randstad</em> is defined as the provinces of Noord-Holland, Zuid-Holland and Utrecht.</p>
<section id="question-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-1">Question 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"housing.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>pop_growth, df<span class="sc">$</span>house_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3046134</code></pre>
</div>
</div>
</section>
<section id="question-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-2">Question 2</h4>
<p>The measured correlation tells us that there is a positive linear relationship between <code>pop_growth</code> and <code>house_price</code>.</p>
</section>
</section>
<section id="model-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="model-1">Model 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"housing.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(house_price <span class="sc">~</span> pop_growth, <span class="at">data =</span> df)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = house_price ~ pop_growth, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-217.67  -71.15  -25.65   41.26  685.62 

Coefficients:
            Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)  393.049     12.074  32.552     &lt; 2e-16 ***
pop_growth    12.979      2.577   5.036 0.000000914 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 118.3 on 248 degrees of freedom
Multiple R-squared:  0.09279,   Adjusted R-squared:  0.08913 
F-statistic: 25.37 on 1 and 248 DF,  p-value: 0.0000009136</code></pre>
</div>
</div>
<section id="question-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-3">Question 3</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pop_growth 
  12.97923 </code></pre>
</div>
</div>
</section>
<section id="question-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-4">Question 4</h4>
<p>We multiply the slope coefficient by 1,000 to convert the answer to euros:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pop_growth 
  12979.23 </code></pre>
</div>
</div>
</section>
<section id="question-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-5">Question 5</h4>
<p>The estimated intercept <span class="math inline">\(b_0\)</span> gives an estimate of <span class="math inline">\(\mathbb{E}[Y_i|x_i=0]\)</span> in units of the dependent variable, which is in thousands of euros. If we multiply <span class="math inline">\(b_0\)</span> by €1,000 we can get an estimate of the average house price in gemeentes with zero population growth. We then check if 0 is in the range of our data for population growth:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>pop_growth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -2.300   1.800   3.400   3.677   5.100  18.200 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(pop_growth)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="2023-resit-solutions_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We do observe gemeentes with zero and near-zero population growth. So the option we should choose is:</p>
<p><em>Houses in gemeentes with zero population growth on average sell for €393,049.</em></p>
</section>
<section id="question-6" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-6">Question 6</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0927893</code></pre>
</div>
</div>
</section>
<section id="question-7" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-7">Question 7</h4>
<p>The proportion left unexplained is <span class="math inline">\(1-R^2\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9072107</code></pre>
</div>
</div>
</section>
<section id="question-8" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-8">Question 8</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1, <span class="at">parm =</span> <span class="st">"pop_growth"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              2.5 %   97.5 %
pop_growth 7.903474 18.05499</code></pre>
</div>
</div>
</section>
<section id="question-9" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-9">Question 9</h4>
<p>If the claim is true, then <span class="math inline">\(\beta_1 &lt; 15\)</span>. The null and alternative hypotheses are then:</p>
<p><span class="math display">\[
H_0: \beta_1 \geq 15 \quad\text{ and } \quad
H_1: \beta_1 &lt; 15
\]</span> Under H0, <span class="math inline">\(T=\frac{B_1-15}{S_{B_1}}\)</span> follows a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-2\)</span> degrees of freedom. We calculate the value of the test statistic:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>b_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="st">"pop_growth"</span>, <span class="st">"Estimate"</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>s_b_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="st">"pop_growth"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>(t <span class="ot">&lt;-</span> (b_1 <span class="sc">-</span> <span class="dv">15</span>) <span class="sc">/</span> s_b_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.7841297</code></pre>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-value is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(t, m1<span class="sc">$</span>df.residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2168561</code></pre>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-value is greater than the significance level of 5%. We therefore fail to reject the null hypothesis. There is insufficient evidence for the claim.</p>
</section>
<section id="question-10" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-10">Question 10</h4>
<p>Run a formal test for heteroskedasticity using a <span class="math inline">\(p\)</span>-value approach. Report the value of the test statistic and <span class="math inline">\(p\)</span>-value. Is there evidence of heteroskedasticity at the 5% level?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add residuals squared to data:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>e_sq <span class="ot">&lt;-</span> m1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate auxiliary model:</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> <span class="fu">lm</span>(e_sq <span class="sc">~</span> pop_growth, <span class="at">data =</span> df)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = e_sq ~ pop_growth, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
-30585 -12830  -8483  -2052 457218 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)     7293       4540   1.607   0.1094  
pop_growth      1793        969   1.850   0.0655 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 44480 on 248 degrees of freedom
Multiple R-squared:  0.01361,   Adjusted R-squared:  0.009635 
F-statistic: 3.422 on 1 and 248 DF,  p-value: 0.06551</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract value of F-statistic:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>(f_stat <span class="ot">&lt;-</span> <span class="fu">summary</span>(aux)<span class="sc">$</span>fstatistic[[<span class="st">"value"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.422436</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-value:</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f_stat, <span class="dv">1</span>, <span class="dv">248</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06550557</code></pre>
</div>
</div>
<p>Because the <span class="math inline">\(p\)</span>-value is greater than the significance level of 5% we fail to reject the null hypothesis of homoskedasticity. There is no evidence for heteroskedasticity at the 5% level.</p>
</section>
</section>
<section id="model-2" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="model-2">Model 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(house_price <span class="sc">~</span> pop_growth <span class="sc">+</span> <span class="fu">I</span>(pop_growth<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> df)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = house_price ~ pop_growth + I(pop_growth^2), data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-181.78  -72.52  -26.33   39.18  683.53 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     385.5164    14.9412  25.802  &lt; 2e-16 ***
pop_growth       17.2184     5.5794   3.086  0.00226 ** 
I(pop_growth^2)  -0.3670     0.4283  -0.857  0.39240    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 118.4 on 247 degrees of freedom
Multiple R-squared:  0.09548,   Adjusted R-squared:  0.08815 
F-statistic: 13.04 on 2 and 247 DF,  p-value: 0.000004148</code></pre>
</div>
</div>
<section id="question-11" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-11">Question 11</h4>
<p>We observe <span class="math inline">\(b_1&gt;0\)</span> and <span class="math inline">\(b_2&lt;0\)</span>, which would indicate a mountain-shaped relationship. However, the estimate of <span class="math inline">\(b_2\)</span> is not significantly different from zero, so there is no evidence of this mountain-shaped relationship. Therefore we choose the option:</p>
<p>Because <code>pop_growth</code> is significantly positive and <code>pop_growth_sq</code> is <em>not</em> significantly negative, there is no evidence of <em>a mountain-shaped</em> relationship between house prices and population growth.</p>
</section>
<section id="question-12" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-12">Question 12</h4>
<ul>
<li>The null hypothesis is that <em>all</em> of <span class="math inline">\(\beta_j=0\)</span> for <span class="math inline">\(j=1,2\)</span>.</li>
<li>The alternative hypothesis is that <em>at least one</em> of <span class="math inline">\(\beta_j\neq 0\)</span> for the same <span class="math inline">\(j\)</span>.</li>
</ul>
<p>The value of <span class="math inline">\(a\)</span> in: <span class="math display">\[
\frac{\frac{SST - a}{k}}{\frac{a}{n-k-1}}
\]</span> is the SSE. We can find that with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3460951</code></pre>
</div>
</div>
<p>The value of the test statistic is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)<span class="sc">$</span>fstatistic[[<span class="st">"value"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.03612</code></pre>
</div>
</div>
<p>The critical value is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.95</span>, <span class="dv">2</span>, m2<span class="sc">$</span>df.residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.032361</code></pre>
</div>
</div>
<p>The F-statistic is greater than the critical value. Therefore we <em>reject</em> <span class="math inline">\(H_0\)</span>. The model is <em>useful</em>.</p>
</section>
<section id="question-13" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-13">Question 13</h4>
<p>We obtain the adjusted <span class="math inline">\(R^2\)</span> for each model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08913119</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08815336</code></pre>
</div>
</div>
<p>Model 2 has a smaller adjusted <span class="math inline">\(R^2\)</span>, despite having more variables. The option we choose is:</p>
<ul>
<li>The adjusted R-squared for the model including <code>pop_growth_sq</code> is smaller. Therefore the model excluding <code>pop_growth_sq</code> is preferred.</li>
</ul>
</section>
</section>
<section id="model-3" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="model-3">Model 3</h2>
<p>One way we can create the <code>randstad</code> variable is with the logical OR operator <code>|</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>randstad <span class="ot">&lt;-</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>province <span class="sc">==</span> <span class="st">"Noord-Holland"</span> <span class="sc">|</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>province <span class="sc">==</span> <span class="st">"Zuid-Holland"</span> <span class="sc">|</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>province <span class="sc">==</span> <span class="st">"Utrecht"</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>randstad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.392</code></pre>
</div>
</div>
<p>Another way which is cleaner is to use the <code>%in%</code> operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>randstad <span class="ot">&lt;-</span> df<span class="sc">$</span>province <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Noord-Holland"</span>, <span class="st">"Zuid-Holland"</span>, <span class="st">"Utrecht"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>randstad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.392</code></pre>
</div>
</div>
<p>Both give the expected mean.</p>
<p>We estimate the model with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(house_price <span class="sc">~</span> randstad, <span class="at">data =</span> df)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = house_price ~ randstad, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-234.21  -70.72  -18.63   44.02  613.99 

Coefficients:
             Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept)   399.430      9.161  43.602          &lt; 2e-16 ***
randstadTRUE  105.475     14.631   7.209 0.00000000000679 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 112.9 on 248 degrees of freedom
Multiple R-squared:  0.1732,    Adjusted R-squared:  0.1699 
F-statistic: 51.97 on 1 and 248 DF,  p-value: 0.00000000000679</code></pre>
</div>
</div>
<section id="question-14" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-14">Question 14</h4>
<p>The expected value of the gemeente average house price <em>inside</em> the Randstad is (in €1000): <span class="math display">\[
\mathbb{E}[Y_i|x_i=1]=\beta_0+\beta_1
\]</span> The expected value of the gemeente average house price <em>outside</em> the Randstad is (in €1000): <span class="math display">\[
\mathbb{E}[Y_i|x_i=0]=\beta_0
\]</span> Therefore our estimate of <span class="math inline">\(\beta_1\)</span> represents the difference in these means. When we multiply by €1000 we convert to euros. The answer is then:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m3<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>randstadTRUE 
    105475.5 </code></pre>
</div>
</div>
</section>
</section>
<section id="model-4" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="model-4">Model 4</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(house_price <span class="sc">~</span> pop_growth <span class="sc">*</span> randstad, <span class="at">data =</span> df)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = house_price ~ pop_growth * randstad, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-220.08  -64.27  -16.90   44.11  620.16 

Coefficients:
                        Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept)              346.652     14.727  23.538       &lt; 2e-16 ***
pop_growth                16.496      3.689   4.472 0.00001184014 ***
randstadTRUE             137.578     23.178   5.936 0.00000000989 ***
pop_growth:randstadTRUE  -11.817      4.883  -2.420        0.0163 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 108.6 on 246 degrees of freedom
Multiple R-squared:  0.2415,    Adjusted R-squared:  0.2322 
F-statistic: 26.11 on 3 and 246 DF,  p-value: 0.00000000000001072</code></pre>
</div>
</div>
<section id="question-15" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-15">Question 15</h4>
<p>Let <span class="math inline">\(x_{i1}\)</span> be population growth and <span class="math inline">\(x_{i2}\)</span> be the Randstad dummy. The model is then: <span class="math display">\[
\mathbb{E}[Y_i|x_{i1},x_{i2}]=\beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_3 x_{i1}x_{i2}
\]</span> For gemeentes with zero population growth in the Randstad::</p>
<p><span class="math display">\[
\mathbb{E}[Y_i|x_{i1}=0,x_{i2}=1]=\beta_0 + \beta_1\times 0 + \beta_2 \times 1 + \beta_3 \times 0 \times 1 = \beta_0 + \beta_2
\]</span> For gemeentes with zero population growth outside the Randstad::</p>
<p><span class="math display">\[
\mathbb{E}[Y_i|x_{i1}=0,x_{i2}=0]=\beta_0 + \beta_1\times 0 + \beta_2 \times 0 + \beta_3 \times 0 \times 0 = \beta_0
\]</span> So <span class="math inline">\(\beta_2\)</span> represents the average difference between the gemeente average house prices inside and outside the Randstad (in €1000) for gemeentes with zero population growth - the number we are looking for. We multiply by €1000 to convert to euros:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m4<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pop_growth 
  16496.29 </code></pre>
</div>
</div>
</section>
<section id="question-16" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-16">Question 16</h4>
<p>In the Randstad, the model is: <span class="math display">\[
\begin{split}
\mathbb{E}[Y_i|x_{i1},x_{i2}=1]&amp;=\beta_0 + \beta_1 x_{i1} + \beta_2 \times 1 + \beta_3 x_{i1} \times 1 \\&amp;= \beta_0 +\beta_2 + \left(\beta_1 +\beta_3\right) x_{i1}
\end{split}
\]</span> Increasing the population growth by one percentage point in the Randstad: <span class="math display">\[
\begin{split}
\mathbb{E}[Y_i|x_{i1}+1,x_{i2}=1]= \beta_0 +\beta_2 + \left(\beta_1 +\beta_3\right) \left(x_{i1}+1\right)
\end{split}
\]</span> Taking differences yields <span class="math inline">\(\beta_1+\beta_3\)</span>. So this multiplied by €1,000 is how much more expensive we expect houses to become in the Randstad when the population growth increases by one percentage point:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(m4<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> m4<span class="sc">$</span>coefficients[<span class="dv">4</span>]) <span class="sc">*</span> <span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pop_growth 
  4679.241 </code></pre>
</div>
</div>
</section>
<section id="question-17" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-17">Question 17</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m4, <span class="fu">data.frame</span>(<span class="at">pop_growth =</span> <span class="dv">4</span>, <span class="at">randstad =</span> <span class="cn">TRUE</span>),</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">"predict"</span>, <span class="at">level =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 502.9475 322.6866 683.2083</code></pre>
</div>
</div>
</section>
</section>
<section id="model-5" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="model-5">Model 5</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>gelderland <span class="ot">&lt;-</span> df<span class="sc">$</span>province <span class="sc">==</span> <span class="st">"Gelderland"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>limburg <span class="ot">&lt;-</span> df<span class="sc">$</span>province <span class="sc">==</span> <span class="st">"Limburg"</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(house_price <span class="sc">~</span> pop_growth <span class="sc">+</span> randstad <span class="sc">+</span> gelderland <span class="sc">+</span> limburg, <span class="at">data =</span> df)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = house_price ~ pop_growth + randstad + gelderland + 
    limburg, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-210.87  -63.74  -14.83   41.07  625.24 

Coefficients:
               Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept)     371.767     14.086  26.394       &lt; 2e-16 ***
pop_growth        8.530      2.488   3.429      0.000711 ***
randstadTRUE     95.449     15.859   6.019 0.00000000638 ***
gelderlandTRUE   28.884     21.541   1.341      0.181208    
limburgTRUE     -43.383     26.352  -1.646      0.100986    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 108.9 on 245 degrees of freedom
Multiple R-squared:  0.2411,    Adjusted R-squared:  0.2287 
F-statistic: 19.46 on 4 and 245 DF,  p-value: 0.00000000000006416</code></pre>
</div>
</div>
<section id="question-18" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-18">Question 18</h4>
<p>When we include Gelderland, Limburg and the Randstad, the “base categories” are then all of Drenthe, Flevoland, Friesland, Groningen, Noord-Brabant, Overijssel, and Zeeland. So the estimated coefficient in front of Gelderland represents the average difference between Gelderland and these provinces, holding all other variables included in the model (population growth) fixed. So the correct option is:</p>
<p>Holding the population growth fixed, the average house price in Gelderland is €28,884 more than the average house price in <em>Drenthe, Flevoland, Friesland, Groningen, Noord-Brabant, Overijssel, and Zeeland.</em></p>
</section>
<section id="question-19" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-19">Question 19</h4>
<p>The null hypothesis is that <em>all</em> of <span class="math inline">\(\beta_j=0\)</span> for <span class="math inline">\(j=3,4\)</span>. The alternative hypothesis is that <em>at least one</em> of <span class="math inline">\(\beta_j\neq 0\)</span> for the same <span class="math inline">\(j\)</span>.</p>
<p>The test statistic is of the form: <span class="math display">\[
\frac{\frac{a - SSE_c}{k-g}}{\frac{SSE_c}{n-k-1}}
\]</span> Here <span class="math inline">\(a\)</span> represents the sum of squared errors in the reduced model. We can obtain this by estimating the reduced model (which we will need later anyway) and getting the sum of squared errors from that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>m5r <span class="ot">&lt;-</span> <span class="fu">lm</span>(house_price <span class="sc">~</span> pop_growth <span class="sc">+</span> randstad, <span class="at">data =</span> df)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(m5r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2971312</code></pre>
</div>
</div>
<p>The value of the test statistic can be found with the <code>anova()</code> function using the complete and reduced models as arguments:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m5, m5r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: house_price ~ pop_growth + randstad + gelderland + limburg
Model 2: house_price ~ pop_growth + randstad
  Res.Df     RSS Df Sum of Sq      F  Pr(&gt;F)  
1    245 2903751                              
2    247 2971312 -2    -67561 2.8502 0.05975 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m5, m5r)[<span class="dv">2</span>, <span class="st">"F"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.850176</code></pre>
</div>
</div>
<p>The critical value is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.95</span>, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> m5<span class="sc">$</span>df.residual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.032663</code></pre>
</div>
</div>
<p>The test statistic is smaller than the critical value. The correct conclusion is then:</p>
<p>Don’t reject H0. The variables are not useful additions to the model.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>